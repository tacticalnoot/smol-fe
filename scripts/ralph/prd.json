{
    "branchName": "ralph/swapper-audit-harness",
    "projectName": "Smol Swapper Audit Harness",
    "quality": {
        "typecheck": "pnpm run typecheck",
        "test": "pnpm test"
    },
    "stories": [
        {
            "id": "SWAP-001",
            "title": "Create swap-audit harness skeleton + artifact pack writer",
            "priority": 1,
            "passes": true,
            "acceptanceCriteria": [
                "Adds scripts/swap-audit folder with config + artifact writer",
                "pnpm audit:swaps exists and prints planned steps"
            ]
        },
        {
            "id": "SWAP-002",
            "title": "Implement Aquarius direct swap build + simulate (XLM->KALE, KALE->XLM)",
            "priority": 2,
            "passes": true,
            "acceptanceCriteria": [
                "Builds an unsigned base tx XDR for both directions",
                "Runs Soroban simulate and saves tx.simulate.json",
                "Asserts only Aquarius contract IDs are invoked"
            ]
        },
        {
            "id": "SWAP-003",
            "title": "Wire OZ Relayer sponsored quote/build + submit + evidence pack",
            "priority": 3,
            "passes": true,
            "acceptanceCriteria": [
                "Calls sponsored/quote then sponsored/build",
                "Signs the sponsored tx (via smart account provider stub)",
                "Submits and writes tx.submit.json + verify.json"
            ]
        },
        {
            "id": "SWAP-004",
            "title": "Add C-address enforcement + allowlist policy assertions",
            "priority": 4,
            "passes": true,
            "acceptanceCriteria": [
                "Refuses G-address sources",
                "Fails on non-XLM/KALE assets",
                "Fails on any unexpected invocation"
            ]
        },
        {
            "id": "SWAP-005",
            "title": "Add xBull Swap API probe mode + report auth model requirements",
            "priority": 5,
            "passes": true,
            "acceptanceCriteria": [
                "Hits /swaps/quote and records response",
                "If tx build exists, records unsigned/signed requirements",
                "Outputs a clear conclusion: 'supports C-auth' or 'does not'"
            ]
        },
        {
            "id": "SWAP-006",
            "title": "Turnstile gate verification checks (only if enabled)",
            "priority": 6,
            "passes": true,
            "acceptanceCriteria": [
                "Harness can require a turnstile token before API calls",
                "Rejects missing/invalid verification"
            ]
        },
        {
            "id": "SWAP-007",
            "title": "Integrate Ohloss provider adapter (requires local docs) + policy hooks",
            "priority": 7,
            "passes": true,
            "acceptanceCriteria": [
                "Ohloss adapter compiles and can be toggled via config",
                "Policy hooks enforce Aquarius-only swap calls"
            ]
        },
        {
            "id": "P0-UX-001",
            "title": "Core music UX audit report (playback, loading, navigation)",
            "priority": 0,
            "passes": true,
            "acceptanceCriteria": [
                "Audit covers playback, data loading, and navigation flows",
                "Report includes state machine, findings, patch plan, and quick wins"
            ]
        }
    ]
}
