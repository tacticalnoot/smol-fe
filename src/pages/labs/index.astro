---
import Layout from "../../layouts/Layout.astro";
import ExperimentCard from "../../components/labs/ExperimentCard.svelte";
import AsteroidsBackground from "../../components/labs/AsteroidsBackground.svelte";
import KonamiEasterEgg from "../../components/labs/KonamiEasterEgg.svelte";

// Experiment Registry
// Experiment Registry (LabTech Source of Truth)
import registry from "../../../labs/registry.json";

const EXPERIMENTS = registry;
---

<Layout title="Smol Labs">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
  </style>
  <div class="min-h-screen bg-black text-[#9ae600] font-pixel p-4 md:p-8 pt-24 relative overflow-hidden">

    <!-- Konami Code Easter Egg -->
    <KonamiEasterEgg client:only="svelte" />

    <!-- Background Effect -->
    <div class="absolute inset-0 opacity-20 pointer-events-none">
        <div class="absolute inset-0 bg-[linear-gradient(rgba(18,18,18,0)_50%,rgba(0,0,0,0.25)_50%),linear-gradient(90deg,rgba(255,0,0,0.06),rgba(0,255,0,0.02),rgba(0,0,255,0.06))] z-10 bg-[length:100%_2px,3px_100%]"></div>
        <div class="absolute inset-0 bg-[radial-gradient(circle_at_center,theme('colors.lime.900')_0%,transparent_70%)] opacity-20"></div>
    </div>
    <AsteroidsBackground client:only="svelte" />
    <div class="absolute inset-0 bg-black/60 z-0 pointer-events-none"></div>
    <div class="absolute inset-0 z-0 pointer-events-none bg-[linear-gradient(rgba(18,16,16,0)_50%,rgba(0,0,0,0.25)_50%),linear-gradient(90deg,rgba(255,0,0,0.06),rgba(0,255,0,0.02),rgba(0,0,255,0.06))] bg-[length:100%_2px,3px_100%]"></div>

    <div class="max-w-7xl mx-auto relative z-20 flex flex-col gap-12">
      
      <!-- Header -->
      <div class="text-center space-y-4 py-8">
        <div class="inline-flex items-center gap-2 border border-[#9ae600]/30 bg-[#9ae600]/5 px-3 py-1 rounded-full mb-4">
            <span class="w-1.5 h-1.5 bg-[#ff424c] rounded-full animate-pulse"></span>
            <span class="text-[8px] md:text-[10px] font-pixel text-[#9ae600] uppercase tracking-widest" style="filter: drop-shadow(0 0 5px rgba(154, 230, 0, 0.5));">Experimental Sandbox // Use at own risk</span>
        </div>
        
        <!-- Updated Header: Smaller, No Hard Shadow, Just Glow -->
        <h1 class="text-3xl md:text-5xl font-black tracking-tighter font-pixel mb-2" style="image-rendering: pixelated;">
          <span class="text-white" style="filter: drop-shadow(0 0 15px rgba(255, 255, 255, 0.6));">SMOL</span><span class="text-[#ff424c]" style="filter: drop-shadow(0 0 20px rgba(255, 66, 76, 0.6));">LABS</span>
        </h1>
        
        <p class="text-[10px] md:text-xs text-slate-500 font-pixel max-w-2xl mx-auto leading-relaxed">
          <span class="text-[#FDDA24] uppercase tracking-widest block mb-2" style="filter: drop-shadow(0 0 8px rgba(253, 218, 36, 0.5));">‚ö† Containment Field Active</span>
          <span class="opacity-70">
            Constructs are isolated for your safety.<br/>
            Experiments automatically generated by <span class="text-white hover:text-[#9ae600] transition-colors cursor-help" title="Recursive Agentic Prototyping Holodeck">R.A.P.H.</span><br/>
            Proceed with scientific curiosity.
          </span>
        </p>

        <!-- LabTech Legend -->
        <div class="flex flex-wrap justify-center gap-6 mt-6 pb-2 text-[8px] font-pixel text-[#555] uppercase tracking-widest border-b border-white/5 mx-auto max-w-lg">
            <div class="flex items-center gap-2" title="Production Ready (Verified)">
                <span class="w-0 h-0 border-l-[4px] border-l-transparent border-r-[4px] border-r-transparent border-b-[6px] border-b-[#4ade80]" style="filter: drop-shadow(0 0 3px #4ade80)"></span>
                <span class="text-[#4ade80]">Live</span>
            </div>
            <div class="flex items-center gap-2" title="Functional (Needs Polish)">
                <span class="w-0 h-0 border-l-[4px] border-l-transparent border-r-[4px] border-r-transparent border-b-[6px] border-b-[#facc15]" style="filter: drop-shadow(0 0 3px #facc15)"></span>
                <span class="text-[#facc15]">Functional</span>
            </div>
            <div class="flex items-center gap-2" title="In Progress (Partial/Mocked)">
                <span class="w-0 h-0 border-l-[4px] border-l-transparent border-r-[4px] border-r-transparent border-b-[6px] border-b-[#fb923c]" style="filter: drop-shadow(0 0 3px #fb923c)"></span>
                <span class="text-[#fb923c]">In Development</span>
            </div>
            <div class="flex items-center gap-2" title="Broken/Unsafe">
                 <span class="w-0 h-0 border-l-[4px] border-l-transparent border-r-[4px] border-r-transparent border-b-[6px] border-b-[#ef4444]" style="filter: drop-shadow(0 0 3px #ef4444)"></span>
                 <span class="text-[#ef4444]">Conceptual</span>
            </div>
        </div>
      </div>

      <!-- Grid -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {EXPERIMENTS.map((exp) => (
            <ExperimentCard 
                client:visible 
                title={exp.title} 
                description={exp.description} 
                href={exp.href} 
                badge={exp.badge}
                isLocked={exp.isLocked}
                tags={exp.tags}
                status_color={exp.status_color}
                readiness_score={exp.readiness_score}
            />
        ))}

        <!-- Placeholder for Future -->
        <div class="border-2 border-dashed border-[#333] rounded-xl p-6 flex flex-col items-center justify-center gap-4 text-center opacity-30 hover:opacity-50 transition-opacity min-h-[200px]">
             <span class="text-2xl grayscale">üß™</span>
             <p class="text-[8px] font-pixel uppercase tracking-widest text-[#555]">More Experiments Incoming</p>
        </div>
      </div>

      <!-- Footer / Status -->
      <div class="flex justify-between items-center border-t border-white/5 pt-8 mt-12 mb-8">
        <div class="flex items-center gap-2 text-[8px] md:text-[10px] text-[#555] font-pixel uppercase tracking-widest">
            <span class="w-1.5 h-1.5 bg-[#9ae600] rounded-full animate-ping"></span>
            System Online // All Experiments Use Smol Songs üéµ
        </div>
        <p class="text-[8px] text-[#333] font-pixel hover:text-[#555] transition-colors cursor-help" title="Try the Konami Code!">
            v0.1.0-alpha // ‚Üë‚Üë‚Üì‚Üì‚Üê‚Üí‚Üê‚ÜíBA
        </p>
      </div>

    </div>
  </div>
</Layout>
